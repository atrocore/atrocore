(function(z,g){typeof exports=="object"&&typeof module<"u"?g(exports):typeof define=="function"&&define.amd?define(["exports"],g):(z=typeof globalThis<"u"?globalThis:z||self,g(z.Svelte={}))})(this,function(z){"use strict";var rt=Object.defineProperty;var ot=(z,g,H)=>g in z?rt(z,g,{enumerable:!0,configurable:!0,writable:!0,value:H}):z[g]=H;var ce=(z,g,H)=>ot(z,typeof g!="symbol"?g+"":g,H);function g(){}function H(t){return t()}function de(){return Object.create(null)}function W(t){t.forEach(H)}function he(t){return typeof t=="function"}function V(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let X;function pe(t,e){return t===e?!0:(X||(X=document.createElement("a")),X.href=e,t===X.href)}function Ne(t){return Object.keys(t).length===0}function d(t,e){t.appendChild(e)}function q(t,e,n){t.insertBefore(e,n||null)}function S(t){t.parentNode&&t.parentNode.removeChild(t)}function m(t){return document.createElement(t)}function I(t){return document.createTextNode(t)}function C(){return I(" ")}function De(){return I("")}function F(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function o(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function je(t){return Array.from(t.childNodes)}function ee(t,e){e=""+e,t.data!==e&&(t.data=e)}function M(t,e,n,l){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,"")}let R;function J(t){R=t}function te(){if(!R)throw new Error("Function called outside component initialization");return R}function He(t){te().$$.on_mount.push(t)}function Ie(t){te().$$.after_update.push(t)}function Me(t){te().$$.on_destroy.push(t)}const Q=[],K=[];let U=[];const _e=[],Ae=Promise.resolve();let ne=!1;function Fe(){ne||(ne=!0,Ae.then(me))}function le(t){U.push(t)}const ie=new Set;let G=0;function me(){if(G!==0)return;const t=R;do{try{for(;G<Q.length;){const e=Q[G];G++,J(e),Qe(e.$$)}}catch(e){throw Q.length=0,G=0,e}for(J(null),Q.length=0,G=0;K.length;)K.pop()();for(let e=0;e<U.length;e+=1){const n=U[e];ie.has(n)||(ie.add(n),n())}U.length=0}while(Q.length);for(;_e.length;)_e.pop()();ne=!1,ie.clear(),J(t)}function Qe(t){if(t.fragment!==null){t.update(),W(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(le)}}function Ue(t){const e=[],n=[];U.forEach(l=>t.indexOf(l)===-1?e.push(l):n.push(l)),n.forEach(l=>l()),U=e}const Y=new Set;let Ge;function se(t,e){t&&t.i&&(Y.delete(t),t.i(e))}function ge(t,e,n,l){if(t&&t.o){if(Y.has(t))return;Y.add(t),Ge.c.push(()=>{Y.delete(t)}),t.o(e)}}function be(t){t&&t.c()}function re(t,e,n){const{fragment:l,after_update:i}=t.$$;l&&l.m(e,n),le(()=>{const s=t.$$.on_mount.map(H).filter(he);t.$$.on_destroy?t.$$.on_destroy.push(...s):W(s),t.$$.on_mount=[]}),i.forEach(le)}function oe(t,e){const n=t.$$;n.fragment!==null&&(Ue(n.after_update),W(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Be(t,e){t.$$.dirty[0]===-1&&(Q.push(t),Fe(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Z(t,e,n,l,i,s,f=null,a=[-1]){const p=R;J(t);const r=t.$$={fragment:null,ctx:[],props:s,update:g,not_equal:i,bound:de(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(p?p.$$.context:[])),callbacks:de(),dirty:a,skip_bound:!1,root:e.target||p.$$.root};f&&f(r.root);let c=!1;if(r.ctx=n?n(t,e.props||{},(u,b,...k)=>{const _=k.length?k[0]:b;return r.ctx&&i(r.ctx[u],r.ctx[u]=_)&&(!r.skip_bound&&r.bound[u]&&r.bound[u](_),c&&Be(t,u)),b}):[],r.update(),c=!0,W(r.before_update),r.fragment=l?l(r.ctx):!1,e.target){if(e.hydrate){const u=je(e.target);r.fragment&&r.fragment.l(u),u.forEach(S)}else r.fragment&&r.fragment.c();e.intro&&se(t.$$.fragment),re(t,e.target,e.anchor),me()}J(p)}class x{constructor(){ce(this,"$$");ce(this,"$$set")}$destroy(){oe(this,1),this.$destroy=g}$on(e,n){if(!he(n))return g;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const i=l.indexOf(n);i!==-1&&l.splice(i,1)}}$set(e){this.$$set&&!Ne(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Ve="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ve);const B=[];function fe(t,e=g){let n;const l=new Set;function i(a){if(V(t,a)&&(t=a,n)){const p=!B.length;for(const r of l)r[1](),B.push(r,t);if(p){for(let r=0;r<B.length;r+=2)B[r][0](B[r+1]);B.length=0}}}function s(a){i(a(t))}function f(a,p=g){const r=[a,p];return l.add(r),l.size===1&&(n=e(i,s)||g),a(t),()=>{l.delete(r),l.size===0&&n&&(n(),n=null)}}return{set:i,update:s,subscribe:f}}const ae=fe({}),N={setTranslations(t){ae.set(t)},has(t,e,n){let l=!1;return ae.subscribe(i=>{if(n in i&&e in i[n]&&t in i[n][e]){l=!0;return}})(),l},get(t,e,n){let l=n;return ae.subscribe(i=>{if(t in i&&e in i[t]&&n in i[t][e]){l=i[t][e][n];return}if(t in i&&e in i[t]&&n in i[t][e]){l=i[t][e][n];return}if(t=="Global"){l=n;return}l=null})(),l},translate(t,e=null,n=null){n=n||"Global",e=e||"labels";let l=N.get(n,e,t);return l===null&&n!="Global"&&(l=N.get("Global",e,t)),l},translateOption(t,e,n=null){let l=N.translate(e,"options",n);return l===null?"":typeof l=="object"?l[t]:t}},we=fe({}),ke={set(t){we.set(t)},get(){let t=null;return we.subscribe(e=>{e&&(t=e)})(),t}},ye=fe(),ve={setNotifier(t){ye.set(t)},notify(t,e=null,n=2e3){ye.subscribe(l=>{l&&l.notify(t,e,2e3)})()}};function Pe(t){let e,n,l,i,s,f,a,p,r,c,u,b,k,_,P;function v(L,D){return L[2]?Je:Re}let h=v(t),y=h(t);return{c(){e=m("div"),n=m("div"),l=m("div"),i=m("span"),i.textContent=`${N.translate("queueManager","labels","QueueItem")}`,s=C(),f=m("span"),a=m("a"),a.innerHTML='<span aria-hidden="true">Ã—</span>',p=C(),y.c(),r=C(),c=m("a"),c.textContent=`${N.translate("View List")}`,u=C(),b=m("div"),k=m("div"),k.textContent=`${N.translate("Loading...")}`,o(i,"class","panel-heading-title"),o(a,"href","/"),o(a,"class","close svelte-1p6ppx8"),o(c,"href","#QueueItem"),o(c,"title",N.translate("View List")),o(c,"class","qp-view-list svelte-1p6ppx8"),o(f,"class","pull-right"),o(l,"class","panel-heading clearfix"),o(k,"class","list-container"),o(b,"class","panel-body"),o(n,"class","panel panel-default"),o(e,"class","queue-panel-container")},m(L,D){q(L,e,D),d(e,n),d(n,l),d(l,i),d(l,s),d(l,f),d(f,a),d(f,p),y.m(f,null),d(f,r),d(f,c),d(n,u),d(n,b),d(b,k),t[9](e),_||(P=F(a,"click",t[6]),_=!0)},p(L,D){h===(h=v(L))&&y?y.p(L,D):(y.d(1),y=h(L),y&&(y.c(),y.m(f,r)))},d(L){L&&S(e),y.d(),t[9](null),_=!1,P()}}}function Re(t){let e,n,l;return{c(){e=m("a"),e.textContent=`${N.translate("Pause")}`,o(e,"href","/"),o(e,"title",N.translate("Pause")),o(e,"class","qm-button")},m(i,s){q(i,e,s),n||(l=F(e,"click",t[8]),n=!0)},p:g,d(i){i&&S(e),n=!1,l()}}}function Je(t){let e,n,l;return{c(){e=m("a"),e.textContent=`${N.translate("Start")}`,o(e,"href","/"),o(e,"title",N.translate("Start")),o(e,"class","qm-button")},m(i,s){q(i,e,s),n||(l=F(e,"click",t[7]),n=!0)},p:g,d(i){i&&S(e),n=!1,l()}}}function Ke(t){let e,n=t[0]&&Pe(t);return{c(){n&&n.c(),e=De()},m(l,i){n&&n.m(l,i),q(l,e,i)},p(l,[i]){l[0]?n?n.p(l,i):(n=Pe(l),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:g,o:g,d(l){l&&S(e),n&&n.d(l)}}}function We(t,e,n){let{isOpen:l=!1}=e,{close:i}=e,{icon:s}=e,f=!1;window.addEventListener("publicDataFetched",_=>{n(2,f=!!_.detail.qmPaused)});let a;function p(_){a&&!a.contains(_.target)&&s&&!s.contains(_.target)&&l===!0&&i()}He(()=>{document.addEventListener("click",p)}),Me(()=>{document.removeEventListener("click",p)});async function r(_){let P=ke.get();if(P)try{const v=await fetch("/api/v1/App/action/QueueManagerUpdate",{method:"POST",headers:{"Content-Type":"application/json","Authorization-Token":btoa(P.user.userName+":"+P.token)},body:JSON.stringify({pause:_})});if(!v.ok)throw new Error("Network response was not ok");await v.json(),ve.notify("Done","success")}catch(v){console.error("Error:",v)}}const c=_=>{_.preventDefault(),i()},u=_=>{_.preventDefault(),r(!1)},b=_=>{_.preventDefault(),r(!0)};function k(_){K[_?"unshift":"push"](()=>{a=_,n(3,a)})}return t.$$set=_=>{"isOpen"in _&&n(0,l=_.isOpen),"close"in _&&n(1,i=_.close),"icon"in _&&n(5,s=_.icon)},[l,i,f,a,r,s,c,u,b,k]}class Xe extends x{constructor(e){super(),Z(this,e,We,Ke,V,{isOpen:0,close:1,icon:5})}}function Se(t){let e;return{c(){e=m("span"),o(e,"class","fas fa-pause-circle pause-icon")},m(n,l){q(n,e,l)},d(n){n&&S(e)}}}function Ye(t){let e,n,l,i,s,f,a,p,r=t[2]&&Se();return s=new Xe({props:{icon:t[0],isOpen:t[1],close:t[4]}}),{c(){e=m("a"),n=m("span"),l=C(),r&&r.c(),i=C(),be(s.$$.fragment),o(n,"class","fas fa-tasks"),o(e,"href","/"),o(e,"class","notifications-button")},m(c,u){q(c,e,u),d(e,n),d(e,l),r&&r.m(e,null),t[6](e),q(c,i,u),re(s,c,u),f=!0,a||(p=F(e,"click",t[7]),a=!0)},p(c,[u]){c[2]?r||(r=Se(),r.c(),r.m(e,null)):r&&(r.d(1),r=null);const b={};u&1&&(b.icon=c[0]),u&2&&(b.isOpen=c[1]),s.$set(b)},i(c){f||(se(s.$$.fragment,c),f=!0)},o(c){ge(s.$$.fragment,c),f=!1},d(c){c&&(S(e),S(i)),r&&r.d(),t[6](null),oe(s,c),a=!1,p()}}}function Ze(t,e,n){let{renderTable:l=()=>{}}=e,i,s=!1,f=!1;window.addEventListener("publicDataFetched",u=>{n(2,f=!!u.detail.qmPaused)});function a(){s||(n(1,s=!0),l())}function p(){n(1,s=!1),window.dispatchEvent(new Event("qmPanelClosed"))}function r(u){K[u?"unshift":"push"](()=>{i=u,n(0,i)})}const c=u=>{u.preventDefault(),a()};return t.$$set=u=>{"renderTable"in u&&n(5,l=u.renderTable)},[i,s,f,a,p,l,r,c]}class xe extends x{constructor(e){super(),Z(this,e,Ze,Ye,V,{renderTable:5})}}function $e(t){let e,n=`${t[0]}px`,l=`${t[0]}px`,i=`${t[1]}px`;return{c(){e=m("div"),o(e,"class","loading-icon spinner svelte-yw8t7l"),M(e,"width",n),M(e,"height",l),M(e,"border-width",i)},m(s,f){q(s,e,f)},p(s,[f]){f&1&&n!==(n=`${s[0]}px`)&&M(e,"width",n),f&1&&l!==(l=`${s[0]}px`)&&M(e,"height",l),f&2&&i!==(i=`${s[1]}px`)&&M(e,"border-width",i)},i:g,o:g,d(s){s&&S(e)}}}function et(t,e,n){let{size:l=40}=e,{thickness:i=4}=e;return t.$$set=s=>{"size"in s&&n(0,l=s.size),"thickness"in s&&n(1,i=s.thickness)},[l,i]}class tt extends x{constructor(e){super(),Z(this,e,et,$e,V,{size:0,thickness:1})}}function qe(t){let e,n;return{c(){e=m("img"),pe(e.src,n=t[1])||o(e,"src",n),o(e,"class","logo"),o(e,"alt",t[0])},m(l,i){q(l,e,i)},p(l,i){i&2&&!pe(e.src,n=l[1])&&o(e,"src",n),i&1&&o(e,"alt",l[0])},d(l){l&&S(e)}}}function Le(t){let e,n,l;return{c(){e=m("a"),n=m("i"),l=I("Restore the system"),o(n,"class","fa fa-history svelte-1qmezxs"),o(e,"href",t[2]),o(e,"target","_blank"),o(e,"class","btn btn-default svelte-1qmezxs"),o(e,"role","button"),M(e,"float","right")},m(i,s){q(i,e,s),d(e,n),d(e,l)},p(i,s){s&4&&o(e,"href",i[2])},d(i){i&&S(e)}}}function Ee(t){let e,n,l,i,s,f;return{c(){e=m("hr"),n=C(),l=m("pre"),i=I(t[3]),o(l,"class","logs-container svelte-1qmezxs")},m(a,p){q(a,e,p),q(a,n,p),q(a,l,p),d(l,i),t[11](l),s||(f=F(l,"scroll",t[8]),s=!0)},p(a,p){p&8&&ee(i,a[3])},d(a){a&&(S(e),S(n),S(l)),t[11](null),s=!1,f()}}}function nt(t){let e,n,l,i,s,f,a,p,r,c,u,b,k,_,P,v,h,y,L=t[4]?"Hide":"Show",D,Te,$,Oe,ze,A,ue,Ce,E=t[1]&&qe(t);c=new tt({props:{size:"40",thickness:"5"}});let T=t[2]&&Le(t),O=t[4]&&t[3]&&Ee(t);return{c(){e=m("div"),n=m("div"),l=m("div"),E&&E.c(),i=C(),s=m("div"),f=m("div"),a=m("h3"),a.textContent="System is updating...",p=C(),r=m("section"),be(c.$$.fragment),u=C(),b=m("h5"),k=I(t[5]),_=C(),P=m("section"),v=m("div"),h=m("button"),y=m("i"),D=I(L),Te=I(" logs"),Oe=C(),T&&T.c(),ze=C(),O&&O.c(),o(l,"class","logo-container"),o(n,"class","panel-heading"),o(b,"class","svelte-1qmezxs"),o(r,"class","progress-section svelte-1qmezxs"),o(y,"class","fa fa-list svelte-1qmezxs"),o(h,"class","btn btn-default svelte-1qmezxs"),h.disabled=$=!t[3],o(v,"class","buttons"),o(P,"class","logs-section"),o(f,"class","form-group"),o(s,"class","panel-body"),o(e,"id","login"),o(e,"class","panel panel-default panel-updating")},m(w,j){q(w,e,j),d(e,n),d(n,l),E&&E.m(l,null),d(e,i),d(e,s),d(s,f),d(f,a),d(f,p),d(f,r),re(c,r,null),d(r,u),d(r,b),d(b,k),d(f,_),d(f,P),d(P,v),d(v,h),d(h,y),d(h,D),d(h,Te),d(v,Oe),T&&T.m(v,null),d(P,ze),O&&O.m(P,null),A=!0,ue||(Ce=F(h,"click",t[7]),ue=!0)},p(w,[j]){w[1]?E?E.p(w,j):(E=qe(w),E.c(),E.m(l,null)):E&&(E.d(1),E=null),(!A||j&32)&&ee(k,w[5]),(!A||j&16)&&L!==(L=w[4]?"Hide":"Show")&&ee(D,L),(!A||j&8&&$!==($=!w[3]))&&(h.disabled=$),w[2]?T?T.p(w,j):(T=Le(w),T.c(),T.m(v,null)):T&&(T.d(1),T=null),w[4]&&w[3]?O?O.p(w,j):(O=Ee(w),O.c(),O.m(P,null)):O&&(O.d(1),O=null)},i(w){A||(se(c.$$.fragment,w),A=!0)},o(w){ge(c.$$.fragment,w),A=!1},d(w){w&&S(e),E&&E.d(),oe(c),T&&T.d(),O&&O.d(),ue=!1,Ce()}}}function lt(t){return t.replace(/^\d{2,4}.\d{2}.\d{2,4} \d{2}:\d{2}:\d{2}/g,"").replace(/^[\-\|\s]+/,"")}function it(t,e,n){let{applicationName:l="AtroCore"}=e,{logoPath:i=null}=e,{logFilePath:s}=e,{restoreLink:f=null}=e,a=!1,p=!1,r=0,c=!0,u="",b,k;Ie(()=>{k&&c&&k.scrollTo(0,k.scrollHeight)});function _(){n(4,a=!a),a||(c=!0)}function P(h){const y=h.currentTarget;c=y.scrollHeight-y.scrollTop===y.clientHeight}setInterval(async()=>{try{const h=await fetch(s,{cache:"no-store"});r+=1,h.ok?(n(3,u=(await h.text()).trim()),u.search("composer")>=0&&n(10,p=!0),r>65&&!p&&n(3,u="Something wrong. Please, reboot the server.")):p?setTimeout(()=>{location.reload()},2e3):r>65&&n(3,u="Something wrong. Please, reboot the server.")}catch(h){console.error("Error: ",h)}},1e3);function v(h){K[h?"unshift":"push"](()=>{k=h,n(6,k)})}return t.$$set=h=>{"applicationName"in h&&n(0,l=h.applicationName),"logoPath"in h&&n(1,i=h.logoPath),"logFilePath"in h&&n(9,s=h.logFilePath),"restoreLink"in h&&n(2,f=h.restoreLink)},t.$$.update=()=>{if(t.$$.dirty&1032)if(u){const h=u.trim().split(`
`);n(5,b=lt(h.pop()))}else p?n(5,b=""):n(5,b="Starting...")},[l,i,f,u,a,b,k,_,P,s,p,v]}class st extends x{constructor(e){super(),Z(this,e,it,nt,V,{applicationName:0,logoPath:1,logFilePath:9,restoreLink:2})}}window.SvelteLanguage=N,window.SvelteUserData=ke,window.SvelteNotifier=ve,z.QueueManagerIcon=xe,z.UpdatePanel=st,Object.defineProperty(z,Symbol.toStringTag,{value:"Module"})});
