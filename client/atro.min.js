(function(z,g){typeof exports=="object"&&typeof module<"u"?g(exports):typeof define=="function"&&define.amd?define(["exports"],g):(z=typeof globalThis<"u"?globalThis:z||self,g(z.Svelte={}))})(this,function(z){"use strict";var st=Object.defineProperty;var rt=(z,g,j)=>g in z?st(z,g,{enumerable:!0,configurable:!0,writable:!0,value:j}):z[g]=j;var ue=(z,g,j)=>rt(z,typeof g!="symbol"?g+"":g,j);function g(){}function j(t){return t()}function ce(){return Object.create(null)}function K(t){t.forEach(j)}function de(t){return typeof t=="function"}function V(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let W;function he(t,e){return t===e?!0:(W||(W=document.createElement("a")),W.href=e,t===W.href)}function Ce(t){return Object.keys(t).length===0}function d(t,e){t.appendChild(e)}function q(t,e,n){t.insertBefore(e,n||null)}function S(t){t.parentNode&&t.parentNode.removeChild(t)}function m(t){return document.createElement(t)}function H(t){return document.createTextNode(t)}function C(){return H(" ")}function Ne(){return H("")}function A(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function o(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function De(t){return Array.from(t.childNodes)}function $(t,e){e=""+e,t.data!==e&&(t.data=e)}function I(t,e,n,l){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,"")}let x;function R(t){x=t}function ee(){if(!x)throw new Error("Function called outside component initialization");return x}function je(t){ee().$$.on_mount.push(t)}function He(t){ee().$$.after_update.push(t)}function Ie(t){ee().$$.on_destroy.push(t)}const F=[],J=[];let Q=[];const pe=[],Me=Promise.resolve();let te=!1;function Ae(){te||(te=!0,Me.then(_e))}function ne(t){Q.push(t)}const le=new Set;let U=0;function _e(){if(U!==0)return;const t=x;do{try{for(;U<F.length;){const e=F[U];U++,R(e),Fe(e.$$)}}catch(e){throw F.length=0,U=0,e}for(R(null),F.length=0,U=0;J.length;)J.pop()();for(let e=0;e<Q.length;e+=1){const n=Q[e];le.has(n)||(le.add(n),n())}Q.length=0}while(F.length);for(;pe.length;)pe.pop()();te=!1,le.clear(),R(t)}function Fe(t){if(t.fragment!==null){t.update(),K(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ne)}}function Qe(t){const e=[],n=[];Q.forEach(l=>t.indexOf(l)===-1?e.push(l):n.push(l)),n.forEach(l=>l()),Q=e}const X=new Set;let Ue;function ie(t,e){t&&t.i&&(X.delete(t),t.i(e))}function me(t,e,n,l){if(t&&t.o){if(X.has(t))return;X.add(t),Ue.c.push(()=>{X.delete(t)}),t.o(e)}}function ge(t){t&&t.c()}function se(t,e,n){const{fragment:l,after_update:i}=t.$$;l&&l.m(e,n),ne(()=>{const s=t.$$.on_mount.map(j).filter(de);t.$$.on_destroy?t.$$.on_destroy.push(...s):K(s),t.$$.on_mount=[]}),i.forEach(ne)}function re(t,e){const n=t.$$;n.fragment!==null&&(Qe(n.after_update),K(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Ge(t,e){t.$$.dirty[0]===-1&&(F.push(t),Ae(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Y(t,e,n,l,i,s,f=null,a=[-1]){const h=x;R(t);const r=t.$$={fragment:null,ctx:[],props:s,update:g,not_equal:i,bound:ce(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(h?h.$$.context:[])),callbacks:ce(),dirty:a,skip_bound:!1,root:e.target||h.$$.root};f&&f(r.root);let c=!1;if(r.ctx=n?n(t,e.props||{},(u,b,...w)=>{const p=w.length?w[0]:b;return r.ctx&&i(r.ctx[u],r.ctx[u]=p)&&(!r.skip_bound&&r.bound[u]&&r.bound[u](p),c&&Ge(t,u)),b}):[],r.update(),c=!0,K(r.before_update),r.fragment=l?l(r.ctx):!1,e.target){if(e.hydrate){const u=De(e.target);r.fragment&&r.fragment.l(u),u.forEach(S)}else r.fragment&&r.fragment.c();e.intro&&ie(t.$$.fragment),se(t,e.target,e.anchor),_e()}R(h)}class Z{constructor(){ue(this,"$$");ue(this,"$$set")}$destroy(){re(this,1),this.$destroy=g}$on(e,n){if(!de(n))return g;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const i=l.indexOf(n);i!==-1&&l.splice(i,1)}}$set(e){this.$$set&&!Ce(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Be="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Be);const G=[];function oe(t,e=g){let n;const l=new Set;function i(a){if(V(t,a)&&(t=a,n)){const h=!G.length;for(const r of l)r[1](),G.push(r,t);if(h){for(let r=0;r<G.length;r+=2)G[r][0](G[r+1]);G.length=0}}}function s(a){i(a(t))}function f(a,h=g){const r=[a,h];return l.add(r),l.size===1&&(n=e(i,s)||g),a(t),()=>{l.delete(r),l.size===0&&n&&(n(),n=null)}}return{set:i,update:s,subscribe:f}}const fe=oe({}),N={setTranslations(t){fe.set(t)},has(t,e,n){let l=!1;return fe.subscribe(i=>{if(n in i&&e in i[n]&&t in i[n][e]){l=!0;return}})(),l},get(t,e,n){let l=n;return fe.subscribe(i=>{if(t in i&&e in i[t]&&n in i[t][e]){l=i[t][e][n];return}if(t in i&&e in i[t]&&n in i[t][e]){l=i[t][e][n];return}if(t=="Global"){l=n;return}l=null})(),l},translate(t,e=null,n=null){n=n||"Global",e=e||"labels";let l=N.get(n,e,t);return l===null&&n!="Global"&&(l=N.get("Global",e,t)),l},translateOption(t,e,n=null){let l=N.translate(e,"options",n);return l===null?"":typeof l=="object"?l[t]:t}},be=oe({}),we={set(t){be.set(t)},get(){let t=null;return be.subscribe(e=>{e&&(t=e)})(),t}},ke=oe(),ye={setNotifier(t){ke.set(t)},notify(t,e=null,n=2e3){ke.subscribe(l=>{l&&l.notify(t,e,2e3)})()}};function ve(t){let e,n,l,i,s,f,a,h,r,c,u,b,w,p,P;function v(L,D){return L[2]?xe:Ve}let _=v(t),y=_(t);return{c(){e=m("div"),n=m("div"),l=m("div"),i=m("span"),i.textContent=`${N.translate("queueManager","labels","QueueItem")}`,s=C(),f=m("span"),a=m("a"),a.innerHTML='<span aria-hidden="true">Ã—</span>',h=C(),y.c(),r=C(),c=m("a"),c.textContent=`${N.translate("View List")}`,u=C(),b=m("div"),w=m("div"),w.textContent=`${N.translate("Loading...")}`,o(i,"class","panel-heading-title"),o(a,"href","/"),o(a,"class","close svelte-1p6ppx8"),o(c,"href","#QueueItem"),o(c,"title",N.translate("View List")),o(c,"class","qp-view-list svelte-1p6ppx8"),o(f,"class","pull-right"),o(l,"class","panel-heading clearfix"),o(w,"class","list-container"),o(b,"class","panel-body"),o(n,"class","panel panel-default"),o(e,"class","queue-panel-container")},m(L,D){q(L,e,D),d(e,n),d(n,l),d(l,i),d(l,s),d(l,f),d(f,a),d(f,h),y.m(f,null),d(f,r),d(f,c),d(n,u),d(n,b),d(b,w),t[9](e),p||(P=A(a,"click",t[6]),p=!0)},p(L,D){_===(_=v(L))&&y?y.p(L,D):(y.d(1),y=_(L),y&&(y.c(),y.m(f,r)))},d(L){L&&S(e),y.d(),t[9](null),p=!1,P()}}}function Ve(t){let e,n,l;return{c(){e=m("a"),e.textContent=`${N.translate("Pause")}`,o(e,"href","/"),o(e,"title",N.translate("Pause")),o(e,"class","qm-button")},m(i,s){q(i,e,s),n||(l=A(e,"click",t[8]),n=!0)},p:g,d(i){i&&S(e),n=!1,l()}}}function xe(t){let e,n,l;return{c(){e=m("a"),e.textContent=`${N.translate("Start")}`,o(e,"href","/"),o(e,"title",N.translate("Start")),o(e,"class","qm-button")},m(i,s){q(i,e,s),n||(l=A(e,"click",t[7]),n=!0)},p:g,d(i){i&&S(e),n=!1,l()}}}function Re(t){let e,n=t[0]&&ve(t);return{c(){n&&n.c(),e=Ne()},m(l,i){n&&n.m(l,i),q(l,e,i)},p(l,[i]){l[0]?n?n.p(l,i):(n=ve(l),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:g,o:g,d(l){l&&S(e),n&&n.d(l)}}}function Je(t,e,n){let{isOpen:l=!1}=e,{close:i}=e,{icon:s}=e,f=!1;window.addEventListener("publicDataFetched",p=>{n(2,f=!!p.detail.qmPaused)});let a;function h(p){a&&!a.contains(p.target)&&s&&!s.contains(p.target)&&l===!0&&i()}je(()=>{document.addEventListener("click",h)}),Ie(()=>{document.removeEventListener("click",h)});async function r(p){let P=we.get();if(P)try{const v=await fetch("/api/v1/App/action/QueueManagerUpdate",{method:"POST",headers:{"Content-Type":"application/json","Authorization-Token":btoa(P.user.userName+":"+P.token)},body:JSON.stringify({pause:p})});if(!v.ok)throw new Error("Network response was not ok");await v.json(),ye.notify("Done","success")}catch(v){console.error("Error:",v)}}const c=p=>{p.preventDefault(),i()},u=p=>{p.preventDefault(),r(!1)},b=p=>{p.preventDefault(),r(!0)};function w(p){J[p?"unshift":"push"](()=>{a=p,n(3,a)})}return t.$$set=p=>{"isOpen"in p&&n(0,l=p.isOpen),"close"in p&&n(1,i=p.close),"icon"in p&&n(5,s=p.icon)},[l,i,f,a,r,s,c,u,b,w]}class Ke extends Z{constructor(e){super(),Y(this,e,Je,Re,V,{isOpen:0,close:1,icon:5})}}function Pe(t){let e;return{c(){e=m("span"),o(e,"class","fas fa-pause-circle pause-icon")},m(n,l){q(n,e,l)},d(n){n&&S(e)}}}function We(t){let e,n,l,i,s,f,a,h,r=t[2]&&Pe();return s=new Ke({props:{icon:t[0],isOpen:t[1],close:t[4]}}),{c(){e=m("a"),n=m("span"),l=C(),r&&r.c(),i=C(),ge(s.$$.fragment),o(n,"class","fas fa-tasks"),o(e,"href","/"),o(e,"class","notifications-button")},m(c,u){q(c,e,u),d(e,n),d(e,l),r&&r.m(e,null),t[6](e),q(c,i,u),se(s,c,u),f=!0,a||(h=A(e,"click",t[7]),a=!0)},p(c,[u]){c[2]?r||(r=Pe(),r.c(),r.m(e,null)):r&&(r.d(1),r=null);const b={};u&1&&(b.icon=c[0]),u&2&&(b.isOpen=c[1]),s.$set(b)},i(c){f||(ie(s.$$.fragment,c),f=!0)},o(c){me(s.$$.fragment,c),f=!1},d(c){c&&(S(e),S(i)),r&&r.d(),t[6](null),re(s,c),a=!1,h()}}}function Xe(t,e,n){let{renderTable:l=()=>{}}=e,i,s=!1,f=!1;window.addEventListener("publicDataFetched",u=>{n(2,f=!!u.detail.qmPaused)});function a(){s||(n(1,s=!0),l())}function h(){n(1,s=!1),window.dispatchEvent(new Event("qmPanelClosed"))}function r(u){J[u?"unshift":"push"](()=>{i=u,n(0,i)})}const c=u=>{u.preventDefault(),a()};return t.$$set=u=>{"renderTable"in u&&n(5,l=u.renderTable)},[i,s,f,a,h,l,r,c]}class Ye extends Z{constructor(e){super(),Y(this,e,Xe,We,V,{renderTable:5})}}function Ze(t){let e,n=`${t[0]}px`,l=`${t[0]}px`,i=`${t[1]}px`;return{c(){e=m("div"),o(e,"class","loading-icon spinner svelte-yw8t7l"),I(e,"width",n),I(e,"height",l),I(e,"border-width",i)},m(s,f){q(s,e,f)},p(s,[f]){f&1&&n!==(n=`${s[0]}px`)&&I(e,"width",n),f&1&&l!==(l=`${s[0]}px`)&&I(e,"height",l),f&2&&i!==(i=`${s[1]}px`)&&I(e,"border-width",i)},i:g,o:g,d(s){s&&S(e)}}}function $e(t,e,n){let{size:l=40}=e,{thickness:i=4}=e;return t.$$set=s=>{"size"in s&&n(0,l=s.size),"thickness"in s&&n(1,i=s.thickness)},[l,i]}class et extends Z{constructor(e){super(),Y(this,e,$e,Ze,V,{size:0,thickness:1})}}function Se(t){let e,n;return{c(){e=m("img"),he(e.src,n=t[1])||o(e,"src",n),o(e,"class","logo"),o(e,"alt",t[0])},m(l,i){q(l,e,i)},p(l,i){i&2&&!he(e.src,n=l[1])&&o(e,"src",n),i&1&&o(e,"alt",l[0])},d(l){l&&S(e)}}}function qe(t){let e,n,l;return{c(){e=m("a"),n=m("i"),l=H("Restore the system"),o(n,"class","fa fa-history svelte-1qmezxs"),o(e,"href",t[2]),o(e,"target","_blank"),o(e,"class","btn btn-default svelte-1qmezxs"),o(e,"role","button"),I(e,"float","right")},m(i,s){q(i,e,s),d(e,n),d(e,l)},p(i,s){s&4&&o(e,"href",i[2])},d(i){i&&S(e)}}}function Le(t){let e,n,l,i,s,f;return{c(){e=m("hr"),n=C(),l=m("pre"),i=H(t[3]),o(l,"class","logs-container svelte-1qmezxs")},m(a,h){q(a,e,h),q(a,n,h),q(a,l,h),d(l,i),t[11](l),s||(f=A(l,"scroll",t[8]),s=!0)},p(a,h){h&8&&$(i,a[3])},d(a){a&&(S(e),S(n),S(l)),t[11](null),s=!1,f()}}}function tt(t){let e,n,l,i,s,f,a,h,r,c,u,b,w,p,P,v,_,y,L=t[4]?"Hide":"Show",D,Ee,Te,Oe,B,ae,ze,E=t[1]&&Se(t);c=new et({props:{size:"40",thickness:"5"}});let T=t[2]&&qe(t),O=t[4]&&Le(t);return{c(){e=m("div"),n=m("div"),l=m("div"),E&&E.c(),i=C(),s=m("div"),f=m("div"),a=m("h3"),a.textContent="System is updating...",h=C(),r=m("section"),ge(c.$$.fragment),u=C(),b=m("h5"),w=H(t[5]),p=C(),P=m("section"),v=m("div"),_=m("button"),y=m("i"),D=H(L),Ee=H(" logs"),Te=C(),T&&T.c(),Oe=C(),O&&O.c(),o(l,"class","logo-container"),o(n,"class","panel-heading"),o(b,"class","svelte-1qmezxs"),o(r,"class","progress-section svelte-1qmezxs"),o(y,"class","fa fa-list svelte-1qmezxs"),o(_,"class","btn btn-default svelte-1qmezxs"),o(v,"class","buttons"),o(P,"class","logs-section"),o(f,"class","form-group"),o(s,"class","panel-body"),o(e,"id","login"),o(e,"class","panel panel-default panel-updating")},m(k,M){q(k,e,M),d(e,n),d(n,l),E&&E.m(l,null),d(e,i),d(e,s),d(s,f),d(f,a),d(f,h),d(f,r),se(c,r,null),d(r,u),d(r,b),d(b,w),d(f,p),d(f,P),d(P,v),d(v,_),d(_,y),d(_,D),d(_,Ee),d(v,Te),T&&T.m(v,null),d(P,Oe),O&&O.m(P,null),B=!0,ae||(ze=A(_,"click",t[7]),ae=!0)},p(k,[M]){k[1]?E?E.p(k,M):(E=Se(k),E.c(),E.m(l,null)):E&&(E.d(1),E=null),(!B||M&32)&&$(w,k[5]),(!B||M&16)&&L!==(L=k[4]?"Hide":"Show")&&$(D,L),k[2]?T?T.p(k,M):(T=qe(k),T.c(),T.m(v,null)):T&&(T.d(1),T=null),k[4]?O?O.p(k,M):(O=Le(k),O.c(),O.m(P,null)):O&&(O.d(1),O=null)},i(k){B||(ie(c.$$.fragment,k),B=!0)},o(k){me(c.$$.fragment,k),B=!1},d(k){k&&S(e),E&&E.d(),re(c),T&&T.d(),O&&O.d(),ae=!1,ze()}}}function nt(t){return t.replace(/^\d{2,4}.\d{2}.\d{2,4} \d{2}:\d{2}:\d{2}/g,"").replace(/^[\-\|\s]+/,"")}function lt(t,e,n){let{applicationName:l="AtroCore"}=e,{logoPath:i=null}=e,{logFilePath:s}=e,{restoreLink:f=null}=e,a=!1,h=!1,r=0,c=!0,u="",b,w;He(()=>{w&&c&&w.scrollTo(0,w.scrollHeight)});function p(){n(4,a=!a),a||(c=!0)}function P(_){const y=_.currentTarget;c=y.scrollHeight-y.scrollTop===y.clientHeight}setInterval(async()=>{try{const _=await fetch(s,{cache:"no-store"});r+=1,_.ok?(n(3,u=(await _.text()).trim()),u.search("composer")>=0&&n(10,h=!0),r>65&&!h&&n(3,u="Something wrong. Please, reboot the server.")):h?setTimeout(()=>{location.reload()},2e3):r>65&&n(3,u="Something wrong. Please, reboot the server.")}catch(_){console.error("Error: ",_)}},1e3);function v(_){J[_?"unshift":"push"](()=>{w=_,n(6,w)})}return t.$$set=_=>{"applicationName"in _&&n(0,l=_.applicationName),"logoPath"in _&&n(1,i=_.logoPath),"logFilePath"in _&&n(9,s=_.logFilePath),"restoreLink"in _&&n(2,f=_.restoreLink)},t.$$.update=()=>{if(t.$$.dirty&1032)if(u){const _=u.trim().split(`
`);n(5,b=nt(_.pop()))}else h?n(5,b=""):n(5,b="Starting...")},[l,i,f,u,a,b,w,p,P,s,h,v]}class it extends Z{constructor(e){super(),Y(this,e,lt,tt,V,{applicationName:0,logoPath:1,logFilePath:9,restoreLink:2})}}window.SvelteLanguage=N,window.SvelteUserData=we,window.SvelteNotifier=ye,z.QueueManagerIcon=Ye,z.UpdatePanel=it,Object.defineProperty(z,Symbol.toStringTag,{value:"Module"})});
